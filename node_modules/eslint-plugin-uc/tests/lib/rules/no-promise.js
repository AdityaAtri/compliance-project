const rule = require("../../../lib/rules/no-promise");
const RuleTester = require("eslint").RuleTester;
const ruleTester = new RuleTester();

ruleTester.run("no-promise", rule, {

  valid: [
    {
      code: '(async function() { const data = await read(); console.log(data) })()',
      parserOptions: {ecmaVersion: 2020}
    },
    {
      code: '(async function() { try { await read() } catch(error) { console.error(error) } })()',
      parserOptions: {ecmaVersion: 2020}
    }
  ],

  invalid: [
    {
      code: '(function() { read().then(data => console.log(data)) })()',
      parserOptions: {ecmaVersion: 2020},
      errors: [
        {
          message: 'Prefer async/await to Promise',
          type: 'Identifier'
        }
      ]
    },
    {
      code: '(function() { read().catch(error => console.error(error)) })()',
      parserOptions: {ecmaVersion: 2020},
      errors: [
        {
          message: 'Prefer async/await to Promise',
          type: 'Identifier'
        }
      ]
    }
  ]
});
