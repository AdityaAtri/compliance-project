const path = require('path');
const fs = require('fs')

module.exports = {
    meta: {
        type: "suggestion",
        docs: {
            description: "enforce use of dataStore getters and setters",
        },
        fixable: false,
    },
    create(context) {
        return {
            Identifier(node) {
                const filepath = path.resolve(context.getFilename());
                const dirpath = path.dirname(filepath);
                const directories = dirpath.split('/')
                const dirname = directories.pop();
                if (directories[directories.length-1] == 'micro_frontends' && !fs.existsSync(path.resolve(filepath, '..', 'README.md'))) {
                    context.report(node, "Readme in '{{dirname}}' is missing", {dirname});
                }
            }
        }
    }
}